{"version":3,"file":"helpers.js","sources":["../../src/moj/helpers.mjs"],"sourcesContent":["export function removeAttributeValue(el, attr, value) {\n  let re, m\n  if (el.getAttribute(attr)) {\n    if (el.getAttribute(attr) === value) {\n      el.removeAttribute(attr)\n    } else {\n      re = new RegExp(`(^|\\\\s)${value}(\\\\s|$)`)\n      m = el.getAttribute(attr).match(re)\n      if (m && m.length === 3) {\n        el.setAttribute(\n          attr,\n          el.getAttribute(attr).replace(re, m[1] && m[2] ? ' ' : '')\n        )\n      }\n    }\n  }\n}\n\nexport function addAttributeValue(el, attr, value) {\n  let re\n  if (!el.getAttribute(attr)) {\n    el.setAttribute(attr, value)\n  } else {\n    re = new RegExp(`(^|\\\\s)${value}(\\\\s|$)`)\n    if (!re.test(el.getAttribute(attr))) {\n      el.setAttribute(attr, `${el.getAttribute(attr)} ${value}`)\n    }\n  }\n}\n\nexport function dragAndDropSupported() {\n  const div = document.createElement('div')\n  return typeof div.ondrop !== 'undefined'\n}\n\nexport function formDataSupported() {\n  return typeof FormData === 'function'\n}\n\nexport function fileApiSupported() {\n  const input = document.createElement('input')\n  input.type = 'file'\n  return typeof input.files !== 'undefined'\n}\n\nexport function nodeListForEach(nodes, callback) {\n  if (window.NodeList.prototype.forEach) {\n    return nodes.forEach(callback)\n  }\n  for (let i = 0; i < nodes.length; i++) {\n    callback.call(window, nodes[i], i, nodes)\n  }\n}\n\n/**\n * Find an elements next sibling\n *\n * Utility function to find an elements next sibling matching the provided\n * selector.\n *\n * @param {HTMLElement} $element - Element to find siblings for\n * @param {string} selector - selector for required sibling\n */\nexport function getNextSibling($element, selector) {\n  if (!$element) return\n  // Get the next sibling element\n  let $sibling = $element.nextElementSibling\n\n  // If there's no selector, return the first sibling\n  if (!selector) return $sibling\n\n  // If the sibling matches our selector, use it\n  // If not, jump to the next sibling and continue the loop\n  while ($sibling) {\n    if ($sibling.matches(selector)) return $sibling\n    $sibling = $sibling.nextElementSibling\n  }\n}\n\n/**\n * Find an elements preceding sibling\n *\n * Utility function to find an elements previous sibling matching the provided\n * selector.\n *\n * @param {HTMLElement} $element - Element to find siblings for\n * @param {string} selector - selector for required sibling\n */\nexport function getPreviousSibling($element, selector) {\n  if (!$element) return\n  // Get the previous sibling element\n  let $sibling = $element.previousElementSibling\n\n  // If there's no selector, return the first sibling\n  if (!selector) return $sibling\n\n  // If the sibling matches our selector, use it\n  // If not, jump to the next sibling and continue the loop\n  while ($sibling) {\n    if ($sibling.matches(selector)) return $sibling\n    $sibling = $sibling.previousElementSibling\n  }\n}\n\nexport function findNearestMatchingElement($element, selector) {\n  // If no element or selector is provided, return null\n  if (!$element) return\n  if (!selector) return\n\n  // Start with the current element\n  let $currentElement = $element\n\n  while ($currentElement) {\n    // First check the current element\n    if ($currentElement.matches(selector)) {\n      return $currentElement\n    }\n\n    // Check all previous siblings\n    let $sibling = $currentElement.previousElementSibling\n    while ($sibling) {\n      // Check if the sibling itself is a heading\n      if ($sibling.matches(selector)) {\n        return $sibling\n      }\n      $sibling = $sibling.previousElementSibling\n    }\n\n    // If no match found in siblings, move up to parent\n    $currentElement = $currentElement.parentElement\n  }\n}\n\n/**\n * Move focus to element\n *\n * Sets tabindex to -1 to make the element programmatically focusable,\n * but removes it on blur as the element doesn't need to be focused again.\n *\n * @param {HTMLElement} $element - HTML element\n * @param {object} [options] - Handler options\n * @param {function(this: HTMLElement): void} [options.onBeforeFocus] - Callback before focus\n * @param {function(this: HTMLElement): void} [options.onBlur] - Callback on blur\n */\nexport function setFocus($element, options = {}) {\n  const isFocusable = $element.getAttribute('tabindex')\n\n  if (!isFocusable) {\n    $element.setAttribute('tabindex', '-1')\n  }\n\n  /**\n   * Handle element focus\n   */\n  function onFocus() {\n    $element.addEventListener('blur', onBlur, { once: true })\n  }\n\n  /**\n   * Handle element blur\n   */\n  function onBlur() {\n    if (options.onBlur) {\n      options.onBlur.call($element)\n    }\n\n    if (!isFocusable) {\n      $element.removeAttribute('tabindex')\n    }\n  }\n\n  // Add listener to reset element on blur, after focus\n  $element.addEventListener('focus', onFocus, { once: true })\n\n  // Focus element\n  if (options.onBeforeFocus) {\n    options.onBeforeFocus.call($element)\n  }\n  $element.focus()\n}\n"],"names":[],"mappings":"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"}